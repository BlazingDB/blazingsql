# Cross Join Suite Test Suite

TEST_SUITE:
  SETUP:
    APPLY_ORDER: True
    USE_PERCENTAGE: False
    ACCEPTABLE_DIFFERENCE: 0
    COMPARE_WITH: drill
    SKIP_WITH:
      - MULTINODE:
        - CUDF

  TEST_01:
    SQL: |
        select * from nation cross join region

  TEST_02:
    SQL: |
        select o_orderkey, o_totalprice,
                         l_linenumber, l_shipmode
                    from orders cross join lineitem
                    where o_orderkey < 6
                    and l_receiptdate > date '1996-07-12'
                    and l_linenumber > 5
                    and o_totalprice < 74029.55
                    and o_clerk = 'Clerk#000000880'
                    and l_shipmode IN ('FOB', 'RAIL')
                    order by o_orderkey, o_totalprice, l_linenumber

  TEST_03:
    SQL: |
      with ordersTemp as (
                    select min(o_orderkey) as priorityKey, o_custkey
                    from orders group by o_custkey
                    ), ordersjoin as( select orders.o_custkey from orders
                    inner join ordersTemp
                    on ordersTemp.priorityKey = orders.o_orderkey)
                    select customer.c_custkey, customer.c_nationkey
                    from customer inner join ordersjoin
                    on ordersjoin.o_custkey =  customer.c_custkey

  TEST_04:
    SQL: |
        with ordersTemp as (
                    select min(orders.o_orderkey) as priorityKey, o_custkey
                    from orders group by o_custkey
                    ), ordersjoin as( select orders.o_orderkey, orders.o_custkey
                    / (orders.o_custkey + 1) as o_custkey,
                    (ordersTemp.priorityKey + 1) as priorityKey from orders
                    inner join ordersTemp on
                    (ordersTemp.priorityKey = orders.o_orderkey)
                    )
                    select (customer.c_custkey + 1)
                    / (customer.c_custkey - customer.c_custkey + 1) from customer
                    inner join ordersjoin on ordersjoin.o_custkey = customer.c_custkey
                    where (customer.c_custkey > 1 or customer.c_custkey < 100)

  